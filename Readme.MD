# ğŸ“ Eduportal â€” PERN Stack Education Portal

A full-stack education portal built with the **PERN Stack** (PostgreSQL, Express, React, Node.js), developed as part of **Mizuka's enterprise solutions** for institute partners. Provides end-to-end class management, announcements, and student enrollment in a single platform.

ğŸ”— **Live Demo:** [eduportal-pern.vercel.app](https://eduportal-pern.vercel.app)

---

## âœ¨ Features

### ğŸ” Authentication & Roles
- JWT-based auth with **Teacher** and **Student** roles
- Each role gets a different dashboard on login
- Forgot password flow with a 6-digit email reset code (15 min expiry)
- Change password from profile with current password verification
- Delete account with full credential confirmation â€” cascades all data

### ğŸ« Class Management
- Teachers create and delete classes with schedule info
- Students browse the full class directory and enroll/unenroll
- Duplicate enrollment prevented at both frontend and backend

### ğŸ“¢ Announcements
- Teachers post announcements per class with optional expiry dates
- Expiry badges: active (teal), expiring soon within 3 days (amber), expired (red)
- Expired announcements automatically filtered out at the database level
- Students see only announcements from their enrolled classes

### ğŸ‘¤ Profile
- Update username with live preview
- Upload profile picture â€” stored on **Cloudinary**
- Responsive avatar with fallback to username initial

### âš¡ Performance
- Pages stay mounted after first visit â€” no refetch on tab switch
- Announcement panels cached per class â€” no repeat API calls on drawer reopen
- Auth context is reactive â€” token changes update the UI without page reload

---

## ğŸ›  Tech Stack

| Layer | Technology |
|---|---|
| **Frontend** | React 18, React Router, Axios, Lucide React |
| **Backend** | Node.js, Express.js |
| **Database** | PostgreSQL (hosted on Neon) |
| **Auth** | JSON Web Tokens, bcrypt |
| **File Storage** | Cloudinary + Multer |
| **Deployment** | Vercel (frontend) |

---

## ğŸ“‚ Project Structure

```
Eduportal-PERN/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ controllers/       # authControl, announcementControl, etc.
â”‚   â”œâ”€â”€ db/                # queryAuth, queryAnnouncements, queryEnrollment
â”‚   â”œâ”€â”€ middleware/        # authMiddleware, uploadMiddleware (Cloudinary)
â”‚   â”œâ”€â”€ routes/            # authRoutes, classRoutes, enrollRoutes, announcements
â”‚   â””â”€â”€ app.js
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/           # authApi, api (classes/enrollments/announcements)
â”‚   â”‚   â”œâ”€â”€ components/    # Layout, Sidebar, Profile, TeacherClasses, Enrolled, etc.
â”‚   â”‚   â”œâ”€â”€ css/           # Per-component stylesheets
â”‚   â”‚   â””â”€â”€ utils/         # AuthContext, auth helpers
â”‚   â””â”€â”€ index.html
â””â”€â”€ README.md
```

---

## ğŸ“‚ Database Schema

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash TEXT NOT NULL,
    role VARCHAR(20) DEFAULT 'student',
    profile_pic TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE classes (
    id SERIAL PRIMARY KEY,
    class_name VARCHAR(100) NOT NULL,
    time_in_pakistan INTEGER NOT NULL,
    teacher_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE enrollments (
    id SERIAL PRIMARY KEY,
    student_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    class_id INTEGER REFERENCES classes(id) ON DELETE CASCADE,
    enrolled_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE announcements (
    id SERIAL PRIMARY KEY,
    class_id INTEGER REFERENCES classes(id) ON DELETE CASCADE,
    teacher_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    expires_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE password_resets (
    email VARCHAR(100) PRIMARY KEY,
    code VARCHAR(6) NOT NULL,
    expires_at TIMESTAMP NOT NULL
);
```

---

## ğŸš¦ API Reference

### Auth â€” `/api/auth`
| Method | Endpoint | Auth | Description |
|---|---|---|---|
| POST | `/login` | âŒ | Login, returns JWT |
| POST | `/register` | âŒ | Register new user |
| PUT | `/update-profile` | âœ… | Update username and/or profile picture |
| PUT | `/change-password` | âœ… | Change password (requires current password) |
| DELETE | `/delete` | âœ… | Delete account with credential verification |
| POST | `/request-reset` | âŒ | Request 6-digit password reset code |
| POST | `/reset-password` | âŒ | Reset password using code |

### Classes â€” `/api/class`
| Method | Endpoint | Auth | Description |
|---|---|---|---|
| GET | `/` | âŒ | All classes |
| POST | `/` | âœ… Teacher | Create class |
| GET | `/mine` | âœ… Teacher | Teacher's own classes |
| GET | `/:id` | âŒ | Single class details |
| DELETE | `/:id` | âœ… Teacher | Delete class â€” cascades enrollments and announcements |

### Enrollments â€” `/api/enroll`
| Method | Endpoint | Auth | Description |
|---|---|---|---|
| POST | `/` | âœ… | Enroll student in class |
| GET | `/class/:id` | âœ… | Get class roster |
| GET | `/student/:id` | âœ… | Get student's enrolled classes |
| DELETE | `/student/:studentId/class/:classId` | âœ… | Unenroll student |

### Announcements â€” `/api/class/:classId/announcements`
| Method | Endpoint | Auth | Description |
|---|---|---|---|
| POST | `/` | âœ… Teacher | Post announcement with optional expiry |
| GET | `/` | âœ… | Get active (non-expired) announcements |
| DELETE | `/:announcementId` | âœ… Teacher | Delete own announcement |

---

## ğŸ”§ Local Setup

**1. Clone the repo**
```bash
git clone https://github.com/Zahooruddin-dev/Eduportal-PERN.git
cd Eduportal-PERN
```

**2. Install dependencies**
```bash
# Backend (from root)
npm install

# Frontend
cd frontend && npm install
```

**3. Create `.env` in the root directory**
```env
DATABASE_URL=your_postgres_connection_string
PORT=3000
JWT_SECRET=your_jwt_secret

CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret
```

> âš ï¸ Never commit your `.env` â€” it is already listed in `.gitignore`.

**4. Run**
```bash
# Backend
npm start

# Frontend (separate terminal)
cd frontend && npm run dev
```

Backend: `http://localhost:3000`  
Frontend: `http://localhost:5173`

---

## ğŸŒ Deployment Notes

- **Frontend** deployed on [Vercel](https://vercel.com) â€” set `VITE_API_URL` env var to your backend URL
- **Backend** can be deployed on Railway, Render, or any Node.js host
- **Database** hosted on [Neon](https://neon.tech) â€” serverless PostgreSQL, free tier works fine
- **Images** stored on [Cloudinary](https://cloudinary.com) â€” free tier sufficient for development

---

## ğŸ“¬ Contact

**Zahooruddin** â€” [mzkhan886@gmail.com](mailto:mzkhan886@gmail.com) â€” [@Zahooruddin-dev](https://github.com/Zahooruddin-dev)